<!DOCTYPE html>
<html>
<head>
  <title>Shark Tank Recap Display</title>
</head>
<body>
  <div id="fetched-content">
    <p>Loading content...</p>
  </div>
  <div id="error-display"></div>
  <div id="console-display"></div>

  <script>
    // ... (other code - urlParams, nameParam, setPageTitleAndBase, fixImages, removeIframes, removeLassoContainers, updateImageSources, displayError, console.error, console.log - same as before)

    function updateHomeLinkHref(newUrl) {
      const homeLink = document.querySelector('a[rel="home"]');
      if (homeLink) {
        homeLink.setAttribute('href', newUrl);
      } else {
        console.warn('No anchor element with rel="home" found.');
      }
    }

    async function fetchAndDisplayHTML() {
      try {
        // ... (fetch from Netlify function - same as before)

        let html = await response.text();

        // **CRUCIAL CHANGE - Handle baseUrl availability:**
        if (baseUrl) {
          html = html.replace(/<head>/i, `<head><base href="${baseUrl}">`);
          updateHomeLinkHref(baseUrl);
        } else {
          console.log("baseUrl is not yet available. Setting home link to example.com.");
          updateHomeLinkHref("https://www.example.com"); // Set to example.com
        }

        const container = document.getElementById('fetched-content');
        if (container) {
          container.innerHTML = html;
          removeLassoContainers();
          fixImages();
          removeIframes();
          updateImageSources();
        } else {
          displayError("Container element not found.");
        }
      } catch (error) {
        displayError('Error fetching HTML: ' + error);
      }
    }

    // ... (rest of the code - init function, etc. - same as before)

  </script>
</body>
</html>
